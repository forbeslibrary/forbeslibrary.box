function definitionListPlugin(e,t){function n(t){if(13==t.keyCode){var n=e.dom.getParent(e.selection.getNode(),"dt, dd");if(n&&e.dom.isEmpty(n)){t.preventDefault();var o=e.dom.getParent(e.selection.getNode(),"dl"),i=e.dom.rename(n,"p");e.dom.split(o,i)}}if(9==t.keyCode){var n=e.dom.getParent(e.selection.getNode(),"dt, dd");n&&(t.preventDefault(),e.execCommand("ToggleDefinitionItem"))}}function o(){var t,n=e.selection,o=e.dom;if(t=o.getParent(n.getNode(),"dt")){var i=n.getBookmark();o.rename(t,"dd"),n.moveToBookmark(i)}else if(t=o.getParent(n.getNode(),"dd")){var i=n.getBookmark();o.rename(t,"dt"),n.moveToBookmark(i)}}function i(){var t=e.selection,n=t.getRng(),o=e.dom,i=o.getParent(t.getNode(),"dl,ul,ol");if(i)if("DL"==i.nodeName.toUpperCase()){var l=t.getBookmark();r(i,n),t.moveToBookmark(l)}else m(i,n);else{var s=o.getParent(t.getNode(),"p");if(s){var l=t.getBookmark(),c=o.rename(s,"dt");i=d(c,"dl"),t.moveToBookmark(l)}else if(!t.isCollapsed()){var g=a(n,!0),i=o.getParent(g[0],"dl");i||(i=o.create("dl"),o.insertAfter(i,g[0])),tinymce.each(g,function(e){var n;n=o.is(e,"p, li, dt")?o.rename(e,"dt"):d(e,"dt");try{o.add(i,n)}catch(a){}t.setCursorLocation(n)})}}o.remove(o.select("dl:empty"))}function d(t,n){var o=e.dom,i=o.create(n);return o.insertAfter(i,t),o.add(i,t),i}function a(t,n){var o=t.commonAncestorContainer,i=[];return tinymce.each(o.childNodes,function(o){var d=e.dom;t.intersectsNode(o)&&(n&&d.is(o,"ul, ol, dl")?tinymce.each(o.childNodes,function(e){i.push(e)}):n&&d.is(o,"p")&&1==o.childNodes.length&&d.is(o.childNodes[0],"ul, ol, dl")?tinymce.each(o.childNodes[0].childNodes,function(e){i.push(e)}):i.push(o))}),i}function r(t,n){var o=e.dom,i=[];(listItem=o.getParent(n.commonAncestorContainer,"dt,dd"))?i.push(listItem):i=a(n);var d=o.rename(i.shift(),"p");o.split(t,d),tinymce.each(i,function(e){var t=d;d=o.rename(e,"p"),o.insertAfter(d,t)}),d.nextSibling&&o.is(d.nextSibling,"dl:empty")&&o.remove(d.nextSibling)}function m(t,n){var o=e.dom,i=[];(listItem=o.getParent(n.commonAncestorContainer,"li"))?i.push(listItem):i=a(n);var r=o.rename(i.shift(),"dt");o.split(t,r),defList=d(r,"dl"),tinymce.each(i,function(e){var t=o.rename(e,"dt");o.add(defList,t)})}e.contentCSS.push(t+"/plugin-style.css"),e.addCommand("ToggleDefinitionItem",o),e.addCommand("ToggleDefinitionList",i),e.on("keydown",n),e.addButton("ToggleDefinitionItem",{text:"DTâ†”DD",tooltip:"Switch Between Term and Definition",icon:!1,cmd:"ToggleDefinitionItem",onPostRender:function(){var t=this;e.on("NodeChange",function(n){t.disabled(!e.dom.getParent(n.element,"dl>dt,dl>dd"))})}}),e.addButton("ToggleDefinitionList",{text:"DL",tooltip:"Definition List",icon:!1,cmd:"ToggleDefinitionList",stateSelector:"dl"})}tinymce.PluginManager.add("definitionlist",definitionListPlugin);